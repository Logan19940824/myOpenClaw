# Audio Extractor & ASR Skill

ä»è§†é¢‘ä¸­æå–éŸ³é¢‘ï¼Œå¹¶ä½¿ç”¨ ASR (è‡ªåŠ¨è¯­éŸ³è¯†åˆ«) ç”Ÿæˆå¸¦æ—¶é—´è½´çš„å­—å¹•æ–‡ä»¶ã€‚

## âœ¨ åŠŸèƒ½ç‰¹ç‚¹

- ğŸµ **æå–éŸ³é¢‘** - ä» MP4 è§†é¢‘ä¸­æå–éŸ³é¢‘ä¸º WAV æ ¼å¼
- ğŸ“ **ASR è¯†åˆ«** - ä½¿ç”¨ OpenAI Whisper è‡ªåŠ¨è¯†åˆ«è¯­éŸ³
- â±ï¸ **ç²¾ç¡®æ—¶é—´è½´** - ç”Ÿæˆå¸¦ç²¾ç¡®æ—¶é—´æˆ³çš„å­—å¹•
- ğŸŒ **å¤šè¯­è¨€æ”¯æŒ** - ä¸­æ–‡ã€è‹±æ–‡ç­‰ 50+ è¯­è¨€
- ğŸ’¾ **å¤šç§æ ¼å¼** - æ”¯æŒ SRTã€VTTã€JSON æ ¼å¼å¯¼å‡º

## ğŸ“¦ å®‰è£…ä¾èµ–

```bash
pip install moviepy openai-whisper

# éœ€è¦å…ˆå®‰è£…ï¼š
# 1. FFmpeg: https://ffmpeg.org/download.html
# 2. å¯¹äº Whisperï¼Œå¯èƒ½éœ€è¦å®‰è£… PyTorch
pip install torch
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. å‘½ä»¤è¡Œä½¿ç”¨

```bash
# åŸºæœ¬ç”¨æ³• - æå–éŸ³é¢‘å¹¶ç”Ÿæˆ SRT å­—å¹•
echo '{"video": "interview.mp4", "output": "./results"}' | python3 index.py

# æŒ‡å®šæ ¼å¼å’Œè¯­è¨€
echo '{
  "video": "lecture.mp4",
  "output": "./output",
  "format": "vtt",
  "language": "en"
}' | python3 index.py

# åªæå–éŸ³é¢‘ï¼Œä¸ç”Ÿæˆå­—å¹•
echo '{
  "video": "speech.mp4",
  "output": "./audio",
  "extract_audio": true
}' | python3 index.py
```

**è¿”å›ç»“æœï¼š**
```json
{
  "success": true,
  "audio_path": "./results/audio_interview.wav",
  "subtitle_path": "./results/subtitles.srt",
  "duration": 120.5,
  "segments": 15,
  "error": null
}
```

### 2. åœ¨ OpenClaw ä¸­ä½¿ç”¨

```
ç”¨æˆ·: "å¸®æˆ‘ä» interview.mp4 æå–éŸ³é¢‘å¹¶ç”Ÿæˆå­—å¹•"
      â†“
Agent: è§£ææ„å›¾ï¼Œè°ƒç”¨ MCP skill
      â†“
MCP: æ‰§è¡Œ audio_extractor()
      â†“
è¾“å‡º: {"success": true, "audio_path": "audio.wav", "subtitle_path": "subtitles.srt"}
```

## ğŸ“ è¾“å‡ºæ–‡ä»¶

```
output/
â”œâ”€â”€ audio.wav              # æå–çš„éŸ³é¢‘ (16kHz, WAV)
â”œâ”€â”€ subtitles.srt          # SRT æ ¼å¼å­—å¹•
â”œâ”€â”€ subtitles.vtt          # VTT æ ¼å¼å­—å¹•
â””â”€â”€ subtitles.json         # JSON æ ¼å¼ï¼ˆå«è¯¦ç»†æ—¶é—´è½´ï¼‰
```

## ğŸ“ å­—å¹•æ ¼å¼ç¤ºä¾‹

### SRT æ ¼å¼
```
1
00:00:00,000 --> 00:00:03,500
æ¬¢è¿æ”¶å¬æœ¬æœŸèŠ‚ç›®ã€‚

2
00:00:03,500 --> 00:00:07,200
ä»Šå¤©æˆ‘ä»¬æ¥è®¨è®ºä¸€ä¸ªé‡è¦çš„è¯é¢˜ã€‚
```

### VTT æ ¼å¼
```
WEBVTT

00:00:00.000 --> 00:00:03.500
æ¬¢è¿æ”¶å¬æœ¬æœŸèŠ‚ç›®ã€‚

00:00:03.500 --> 00:00:07.200
ä»Šå¤©æˆ‘ä»¬æ¥è®¨è®ºä¸€ä¸ªé‡è¦çš„è¯é¢˜ã€‚
```

### JSON æ ¼å¼
```json
{
  "format": "whisper",
  "language": "zh",
  "segments": [
    {
      "start": 0.0,
      "end": 3.5,
      "text": "æ¬¢è¿æ”¶å¬æœ¬æœŸèŠ‚ç›®ã€‚"
    },
    {
      "start": 3.5,
      "end": 7.2,
      "text": "ä»Šå¤©æˆ‘ä»¬æ¥è®¨è®ºä¸€ä¸ªé‡è¦çš„è¯é¢˜ã€‚"
    }
  ],
  "created_at": "2024-01-15T10:30:00"
}
```

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### 1. è§†é¢‘ä¼šè®®è®°å½•
```json
{
  "video": "meeting.mp4",
  "output": "./meeting-records",
  "format": "srt",
  "language": "zh",
  "extract_audio": true
}
```

### 2. è¯¾ç¨‹è§†é¢‘å­—å¹•
```json
{
  "video": "lecture.mp4",
  "output": "./course-subtitles",
  "format": "vtt",
  "language": "zh"
}
```

### 3. æ’­å®¢è½¬æ–‡å­—
```json
{
  "video": "podcast.mp4",
  "output": "./podcast-transcript",
  "format": "json",
  "language": "zh"
}
```

### 4. è‹±æ–‡è§†é¢‘åŒè¯­å­—å¹•
```json
{
  "video": "english-talk.mp4",
  "output": "./transcript",
  "format": "srt",
  "language": "en"
}
```

## ğŸ› ï¸ æŠ€æœ¯åŸç†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¾“å…¥è§†é¢‘ (MP4)                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. æå–éŸ³é¢‘ (MoviePy)                                           â”‚
â”‚  - åˆ†ç¦»è§†é¢‘å’ŒéŸ³é¢‘è½¨é“                                             â”‚
â”‚  - è½¬æ¢ä¸º WAV æ ¼å¼ (16kHz, 16bit)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. ASR è¯­éŸ³è¯†åˆ« (Whisper)                                       â”‚
â”‚  - åŠ è½½ Whisper æ¨¡å‹ (base/small/medium/large)                  â”‚
â”‚  - é€æ®µè¯†åˆ«è¯­éŸ³å†…å®¹                                               â”‚
â”‚  - è¾“å‡ºå¸¦æ—¶é—´æˆ³çš„æ–‡æœ¬                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. æ ¼å¼è½¬æ¢                                                      â”‚
â”‚  - SRT: WebVTT ç®€åŒ–ç‰ˆï¼Œå…¼å®¹æ€§æœ€å¥½                                 â”‚
â”‚  - VTT: Web æ ‡å‡†å­—å¹•æ ¼å¼                                         â”‚
â”‚  - JSON: åŸå§‹æ•°æ®ï¼ŒåŒ…å«å®Œæ•´æ—¶é—´è½´                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¾“å‡ºæ–‡ä»¶                                                        â”‚
â”‚  - audio.wav (éŸ³é¢‘)                                              â”‚
â”‚  - subtitles.xxx (å­—å¹•)                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **é¦–æ¬¡è¿è¡Œè¾ƒæ…¢** - Whisper æ¨¡å‹é¦–æ¬¡åŠ è½½éœ€è¦ä¸‹è½½
2. **å†…å­˜å ç”¨** - å¤§æ¨¡å‹éœ€è¦è¾ƒå¤šå†…å­˜
3. **è¯­è¨€è®¾ç½®** - è®¾ç½®æ­£ç¡®çš„è¯­è¨€å¯æé«˜å‡†ç¡®ç‡
4. **éŸ³é¢‘è´¨é‡** - æ¸…æ™°çš„éŸ³é¢‘è¯†åˆ«æ•ˆæœæ›´å¥½

## ğŸ› å¸¸è§é—®é¢˜

### Q: è¯†åˆ«å‡†ç¡®ç‡ä¸é«˜ï¼Ÿ
A: å°è¯•ä½¿ç”¨æ›´å¤§çš„ Whisper æ¨¡å‹ï¼ˆmedium/largeï¼‰

### Q: æ”¯æŒå®æ—¶å­—å¹•å—ï¼Ÿ
A: å½“å‰ç‰ˆæœ¬åªæ”¯æŒç¦»çº¿å¤„ç†

### Q: èƒ½å¤„ç†é•¿è§†é¢‘å—ï¼Ÿ
A: Whisper å¯¹é•¿è§†é¢‘æœ‰é™åˆ¶ï¼Œå»ºè®®åˆ†æ®µå¤„ç†

### Q: æ€ä¹ˆé€‰æ‹©æ¨¡å‹å¤§å°ï¼Ÿ

| æ¨¡å‹ | å‚æ•°é‡ | é€Ÿåº¦ | å‡†ç¡®ç‡ | æ¨èåœºæ™¯ |
|------|--------|------|--------|----------|
| tiny | 39M | æœ€å¿« | è¾ƒä½ | å¿«é€Ÿé¢„è§ˆ |
| base | 74M | å¿« | ä¸€èˆ¬ | æ—¥å¸¸ä½¿ç”¨ |
| small | 244M | ä¸­ | è¾ƒå¥½ | æ­£å¼åœºæ™¯ |
| medium | 769M | æ…¢ | é«˜ | é«˜ç²¾åº¦éœ€æ±‚ |
| large | 1550M | æœ€æ…¢ | æœ€é«˜ | ä¸“ä¸šåˆ¶ä½œ |

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

| è§†é¢‘é•¿åº¦ | æ¨¡å‹ | é¢„è®¡æ—¶é—´ | å†…å­˜å ç”¨ |
|----------|------|----------|----------|
| 1 åˆ†é’Ÿ | base | ~5 ç§’ | ~1GB |
| 10 åˆ†é’Ÿ | base | ~30 ç§’ | ~1GB |
| 1 å°æ—¶ | small | ~10 åˆ†é’Ÿ | ~3GB |

## ğŸ“ License

åŸºäº MIT Licenseã€‚

Whisper æ¨¡å‹æ¥è‡ª OpenAI: https://github.com/openai/whisper
