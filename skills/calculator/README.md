# Calculator MCP Skill 示例

这个示例展示了如何在 OpenClaw 中通过 MCP 协议调用 skill。

## 目录结构

```
skills/
└── calculator/
    ├── SKILL.md        # Skill 描述文件
    └── index.js        # MCP Handler 实现
```

## 1. SKILL.md - 描述文件

每个 skill 需要一个 `SKILL.md` 文件，包含：

- **name**: Skill 名称
- **description**: 功能描述  
- **parameters**: MCP 参数定义
- **使用示例**: 告诉 Agent 如何调用

## 2. index.js - MCP Handler

实现 MCP 协议的处理逻辑：

```javascript
// 输入: JSON 字符串 (从 stdin 读取)
// 输出: JSON 字符串 (打印到 stdout)

const input = JSON.parse(getLineFromStdin());
const result = calculate(input.action, input.a, input.b);
console.log(JSON.stringify({ result, error }));
```

## 3. MCP 调用流程

```
┌─────────────────────────────────────────────────────────────────┐
│  Agent (理解用户意图)                                            │
└─────────────────────────────────────────────────────────────────┘
    │
    │ "计算 10 + 5"
    ▼
┌─────────────────────────────────────────────────────────────────┐
│  MCP Client (构建请求)                                           │
└─────────────────────────────────────────────────────────────────┘
    │
    │ {
    │   "tool": "calculator",
    │   "action": "add",
    │   "a": 10,
    │   "b": 5
    │ }
    ▼
┌─────────────────────────────────────────────────────────────────┐
│  MCP Handler (执行计算)                                          │
└─────────────────────────────────────────────────────────────────┘
    │
    │ index.js 解析输入，执行运算
    ▼
┌─────────────────────────────────────────────────────────────────┐
│  返回结果                                                        │
└─────────────────────────────────────────────────────────────────┘
    │
    │ {
    │   "result": 15,
    │   "error": null
    │ }
    ▼
┌─────────────────────────────────────────────────────────────────┐
│  Agent (生成回复)                                                │
└─────────────────────────────────────────────────────────────────┘
    │
    │ "10 + 5 = 15"
```

## 4. 测试方式

### 直接测试:
```bash
echo '{"action": "add", "a": 10, "b": 5}' | node index.js
# 输出: {"result":15,"error":null}
```

### 在 OpenClaw 中使用:

1. 将 skill 放到 `skills/` 目录
2. 在 `SKILL.md` 中定义接口
3. Agent 会自动读取 SKILL.md 并生成调用代码
4. 用户发送指令，Agent 通过 MCP 调用 skill

## 5. 更多示例

```json
// 乘法
{"action": "mul", "a": 6, "b": 7}
// 结果: 42

// 除法
{"action": "div", "a": 20, "b": 4}
// 结果: 5

// 减法
{"action": "sub", "a": 100, "b": 30}
// 结果: 70
```

## 6. 错误处理

```json
// 除以零
{"action": "div", "a": 10, "b": 0}
// 输出: {"result":null,"error":"除数不能为零"}
```
